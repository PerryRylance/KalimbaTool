jQuery(function($) {
	
	function getTestMIDI()
	{
		// Create a file and track, push the track onto the file
		/*var file = new MIDIFile();
		
		var track = new MIDITrack();
		file.tracks.push(track);

		// Push some events onto the track
		var semitones=[0,1,2,3,4,5,6,7,8,9,10,11,12];
		
		var root = 60; // Middle C
		
		for(var i = 0; i < semitones.length; i++)
		{
			var e = new MIDIControlEvent(MIDIControlEvent.NOTE_ON, root + semitones[i], 127);
			
			if(i > 0)
				e.delta = file.timeDivision / 8;		// Space events out by one quarter note (crotchet) each
			
			track.events.push(e);
		}

		for(var i = 0; i < semitones.length; i++)
		{
			var e = new MIDIControlEvent(MIDIControlEvent.NOTE_OFF, root + semitones[i], 127);
			
			if(i == 0)
				e.delta = file.timeDivision * 4;	// Wait for one measure (bar) and then send all notes off
			
			track.events.push(e);
		}
		
		return file;*/
		
		var binary = atob("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N1qIAIA3AIIAkDlahgCAOQAAkDtahgCAOwAAkDxahACAPAAAkEFahgCAQQAAkEBaiACAQACCAJBFWoYAgEUAAJBHWoYAgEcAAJBIWoQAgEgAAJBFWoYAgEUAAJBDWogAgEMAggCQRVqGAIBFAACQR1qGAIBHAACQSFqEAIBIAACQTVqgAIBNAACQTFqgAIBMAACQNFqBAIA0AACQN1qBAIA3AACQOVmWAIA5AACQPFKCAIA8AACQO1GCAIA7AACQOVCCAIA5AACQN0+CAIA3AACQNU6eAIA1AACQNESBAIA0AACQNUSBAIA1AACQN0SYAIA3AACQPDuCAIA8AACQOzuCAIA7AACQOTqCAIA5AACQNzmCAIA3AACQNzieAIA3AIIAkEAtgQCAQAAAkEMtgQCAQwAAkEUslgCARQAAkEglggCASAAAkEckggCARwAAkEUjggCARQAAkEMiggCAQwAAkEEhngCAQQAAkEAXgQCAQAAAkEEXgQCAQQAAkEMXmACAQwAAkEgOggCASAAAkEcOggCARwAAkEUNggCARQAAkEMMggCAQwAAkEMLngCAQwCCAf8vAE1UcmsAAAJtAP8DEEJsb3duIEJvdHRsZSAoMikAwUwAkTRaoACBNAAAkTBaoACBMAAAkTRaoACBNAAAkS9aoACBLwAAkTRaoACBNAAAkTBaoACBMAAAkTRaoACBNAAAkS9aoACBLwAAkS1aoACBLQAAkS1aoACBLQAAkTBakACBMAAAkTVakACBNQAAkTxakACBPAAAkTVakACBNQAAkTBakACBMAAAkTVakACBNQAAkTxakACBPAAAkTVakACBNQAAkTVakACBNQAAkTBakACBMAAAkTVakACBNQAAkTBakACBMAAAkTVakACBNQAAkTBakACBMAAAkTVakACBNQAAkTVakACBNQAAkTVakACBNQAAkTBakACBMAAAkTBakACBMAAAkTRaoACBNAAAkTBaoACBMAAAkTRaoACBNAAAkS9aoACBLwAAkTRaoACBNAAAkTBaoACBMAAAkTRaoACBNAAAkS9aoACBLwAAkS1aoACBLQAAkS1aoACBLQAAkTBakACBMAAAkTVakACBNQAAkTxakACBPAAAkTVakACBNQAAkTBakACBMAAAkTVakACBNQAAkTxakACBPAAAkTVakACBNQAAkTVakACBNQAAkTBakACBMAAAkTVakACBNQAAkTBakACBMAAAkTVakACBNQAAkTBakACBMAAAkTVakACBNQAAkTVakACBNQAAkTVakACBNQAAkTBakACBMAAAkTBakACBMAAAkTRaoACBNAAAkTBOoACBMAAAkTREoACBNAAAkS84oACBLwAAkTQtoACBNAAAkTAhoACBMAAAkTQXoACBNAAAkS8LoACBLwAB/y8ATVRyawAAAm8A/wMSTGVhZCA4IChiYXNzK2xlYWQpAMJXAJIhUKAAgiEAAJIdUKAAgh0AAJIYUKAAghgAAJIfUKAAgh8AAJIhUKAAgiEAAJIdUKAAgh0AAJIYUKAAghgAAJIfUKAAgh8AAJIhUKAAgiEAAJIhUKAAgiEAAJIYUJAAghgAAJIdUJAAgh0AAJIYUJAAghgAAJIdUJAAgh0AAJIYUJAAghgAAJIdUJAAgh0AAJIYUJAAghgAAJIdUJAAgh0AAJIdUJAAgh0AAJIYUJAAghgAAJIdUJAAgh0AAJIYUJAAghgAAJIdUJAAgh0AAJIYUJAAghgAAJIdUJAAgh0AAJIdUJAAgh0AAJIdUJAAgh0AAJIYUJAAghgAAJIYUJAAghgAAJIhUKAAgiEAAJIdUKAAgh0AAJIYUKAAghgAAJIfUKAAgh8AAJIhUKAAgiEAAJIdUKAAgh0AAJIYUKAAghgAAJIfUKAAgh8AAJIhUKAAgiEAAJIhUKAAgiEAAJIYUJAAghgAAJIdUJAAgh0AAJIYUJAAghgAAJIdUJAAgh0AAJIYUJAAghgAAJIdUJAAgh0AAJIYUJAAghgAAJIdUJAAgh0AAJIdUJAAgh0AAJIYUJAAghgAAJIdUJAAgh0AAJIYUJAAghgAAJIdUJAAgh0AAJIYUJAAghgAAJIdUJAAgh0AAJIdUJAAgh0AAJIdUJAAgh0AAJIYUJAAghgAAJIYUJAAghgAAJIhUKAAgiEAAJIdRqAAgh0AAJIYPKAAghgAAJIfMqAAgh8AAJIhKKAAgiEAAJIdHqAAgh0AAJIYFKAAghgAAJIfCqAAgh8AAf8vAE1UcmsAAAyzAP8DClRhaWtvIERydW0Aw3QAkzdQggCDNwCMAJM3UIIAgzcAAJM3UIIAgzcAjACTN1CCAIM3AACTN1CCAIM3AIwAkzdQggCDNwAAkzdQggCDNwCMAJM3UIIAgzcAAJM3UIIAgzcAjACTN1CCAIM3AACTN1CCAIM3AIwAkzdQggCDNwAAkzdQggCDNwCMAJM3UIIAgzcAAJM3UIIAgzcAjACTN1CCAIM3AACTN1CCAIM3AIwAkzdQggCDNwAAkzdQggCDNwCMAJM3UIIAgzcAAJM3UIIAgzcAjACTN1CCAIM3AACTN1CCAIM3AIwAkzdQggCDNwAAkzdQggCDNwCMAJM3UIIAgzcAAJM3UIIAgzcAjACTN1CCAIM3AACTN1CCAIM3AIwAkzdQggCDNwAAkzdQggCDNwCMAJM3UIIAgzcAAJM3UIIAgzcAjACTN1CCAIM3AACTN1CCAIM3AIwAkzdQggCDNwAAkzdQggCDNwCEAJM3UIIAgzcAAJM3UIIAgzcAhACTN1CCAIM3AACTN1CCAIM3AIQAkzdQggCDNwAAkzdQggCDNwCEAJM3UIIAgzcAAJM3UIIAgzcAhACTN1CCAIM3AACTN1CCAIM3AIQAkzdQggCDNwAAkzdQggCDNwCEAJM3UIIAgzcAAJM3UIIAgzcAhACTN1CCAIM3AACTN1CCAIM3AIQAkzdQggCDNwAAkzdQggCDNwCEAJM3UIIAgzcAAJM3UIIAgzcAhACTN1CCAIM3AACTN1CCAIM3AIQAkzdQggCDNwAAkzdQggCDNwCEAJM3UIIAgzcAAJM3UIIAgzcAhACTN1CCAIM3AACTN1CCAIM3AIQAkzdQggCDNwAAkzdQggCDNwCEAJM3UIIAgzcAAJM3UIIAgzcAhACTN1CCAIM3AACTN1CCAIM3AIQAkzdQggCDNwAAkzdQggCDNwCEAJM3UIIAgzcAAJM3UIIAgzcAhACTN1CCAIM3AACTN1CCAIM3AIQAkzdQggCDNwAAkzdQggCDNwCEAJM3UIIAgzcAAJM3UIIAgzcAhACTN1CCAIM3AACTN1CCAIM3AIQAkzdQggCDNwAAkzdQggCDNwCEAJM3UIIAgzcAAJM3UIIAgzcAhACTN1CCAIM3AACTN1CCAIM3AIQAkzdQggCDNwAAkzdQggCDNwCEAJM3UIIAgzcAAJM3UIIAgzcAhACTN1CCAIM3AACTN1CCAIM3AIQAkzdQggCDNwAAkzdQggCDNwCEAJM3UIIAgzcAAJM3UIIAgzcAhACTN1CCAIM3AACTN1CCAIM3AIQAkzdQggCDNwAAkzdQggCDNwCEAJM3UIIAgzcAAJM3UIIAgzcAhACTN1CCAIM3AACTN1CCAIM3AIQAkzdQggCDNwAAkzdQggCDNwCEAJM3UIIAgzcAAJM3UIIAgzcAhACTN1CCAIM3AACTN1CCAIM3AIQAkzdQggCDNwAAkzdQggCDNwCEAJM3UIIAgzcAAJM3UIIAgzcAhACTN1CCAIM3AACTN1CCAIM3AIQAkzdQggCDNwAAkzdQggCDNwCEAJM3UIIAgzcAAJM3UIIAgzcAhACTN1CCAIM3AACTN1CCAIM3AIQAkzdQggCDNwAAkzdQggCDNwCEAJM3UIIAgzcAAJM3UIIAgzcAhACTN1CCAIM3AACTN1CCAIM3AIQAkzdQggCDNwAAkzdQggCDNwCEAJM3UIIAgzcAAJM3UIIAgzcAhACTN1CCAIM3AACTN1CCAIM3AIQAkzdQggCDNwAAkzdQggCDNwCEAJM3UIIAgzcAAJM3UIIAgzcAhACTN1CCAIM3AACTN1CCAIM3AIQAkzdQggCDNwAAkzdQggCDNwCEAJM3UIIAgzcAAJM3UIIAgzcAhACTN1CCAIM3AACTN1CCAIM3AIQAkzdQggCDNwAAkzdQggCDNwCEAJM3UIIAgzcAAJM3UIIAgzcAhACTN1CCAIM3AACTN1CCAIM3AIQAkzdQggCDNwAAkzdQggCDNwCEAJM3UIIAgzcAAJM3UIIAgzcAhACTN1CCAIM3AACTN1CCAIM3AIQAkzdQggCDNwAAkzdQggCDNwCEAJM3UIIAgzcAAJM3UIIAgzcAhACTN1CCAIM3AACTN1CCAIM3AIQAkzdQggCDNwAAkzdQggCDNwCEAJM3UIIAgzcAAJM3UIIAgzcAhACTN1CCAIM3AACTN1CCAIM3AIQAkzdQggCDNwAAkzdQggCDNwCEAJM3UIIAgzcAAJM3UIIAgzcAhACTN1CCAIM3AACTN1CCAIM3AIQAkzdQggCDNwAAkzdQggCDNwCEAJM3UIIAgzcAAJM3UIIAgzcAhACTN1CCAIM3AACTN1CCAIM3AIQAkzdQggCDNwAAkzdQggCDNwCEAJM3UIIAgzcAAJM3UIIAgzcAhACTN1CCAIM3AACTN1CCAIM3AIQAkzdQggCDNwAAkzdQggCDNwCEAJM3UIIAgzcAAJM3UIIAgzcAhACTN1CCAIM3AACTN1CCAIM3AIQAkzdQggCDNwAAkzdQggCDNwCEAJM3UIIAgzcAAJM3UIIAgzcAhACTN1CCAIM3AACTN1CCAIM3AIQAkzdQggCDNwAAkzdQggCDNwCEAJM3UIIAgzcAAJM3UIIAgzcAhACTN1CCAIM3AACTN1CCAIM3AIQAkzdQggCDNwAAkzdQggCDNwCEAJM3UIIAgzcAAJM3UIIAgzcAhACTN1CCAIM3AACTN1CCAIM3AIQAkzdQggCDNwAAkzdQggCDNwCEAJM3UIIAgzcAAJM3UIIAgzcAhACTN1CCAIM3AACTN1CCAIM3AIQAkzdQggCDNwAAkzdQggCDNwCEAJM3UIIAgzcAAJM3UIIAgzcAhACTN1CCAIM3AACTN1CCAIM3AIQAkzdQggCDNwAAkzdQggCDNwCEAJM3UIIAgzcAAJM3UIIAgzcAhACTN1CCAIM3AACTN1CCAIM3AIQAkzdQggCDNwAAkzdQggCDNwCEAJM3UIIAgzcAAJM3UIIAgzcAhACTN1CCAIM3AACTN1CCAIM3AIQAkzdQggCDNwAAkzdQggCDNwCEAJM3UIIAgzcAAJM3UIIAgzcAhACTN1CCAIM3AACTN1CCAIM3AIQAkzdQggCDNwAAkzdQggCDNwCEAJM3UIIAgzcAAJM3UIIAgzcAhACTN1CCAIM3AACTN1CCAIM3AIQAkzdQggCDNwAAkzdQggCDNwCEAJM3UIIAgzcAAJM3UIIAgzcAhACTN1CCAIM3AACTN1CCAIM3AIQAkzdQggCDNwAAkzdQggCDNwCEAJM3UIIAgzcAAJM3UIIAgzcAhACTN1CCAIM3AACTN1CCAIM3AIQAkzdQggCDNwAAkzdQggCDNwCEAJM3UIIAgzcAAJM3UIIAgzcAhACTN1CCAIM3AACTN1CCAIM3AIQAkzdQggCDNwAAkzdQggCDNwCEAJM3UIIAgzcAAJM3UIIAgzcAhACTN1CCAIM3AACTN1CCAIM3AIQAkzdQggCDNwAAkzdQggCDNwCEAJM3ToIAgzcAAJM3ToIAgzcAhACTN0yCAIM3AACTN0uCAIM3AIQAkzdJggCDNwAAkzdJggCDNwCEAJM3RoIAgzcAAJM3RoIAgzcAhACTN0SCAIM3AACTN0OCAIM3AIQAkzdCggCDNwAAkzdBggCDNwCEAJM3P4IAgzcAAJM3PoIAgzcAhACTNz2CAIM3AACTNzyCAIM3AIQAkzc6ggCDNwAAkzc6ggCDNwCEAJM3OIIAgzcAAJM3N4IAgzcAhACTNzWCAIM3AACTNzWCAIM3AIQAkzcyggCDNwAAkzcyggCDNwCEAJM3MIIAgzcAAJM3L4IAgzcAhACTNy6CAIM3AACTNy2CAIM3AIQAkzcrggCDNwAAkzcqggCDNwCEAJM3KYIAgzcAAJM3KIIAgzcAhACTNyaCAIM3AACTNyaCAIM3AIQAkzckggCDNwAAkzcjggCDNwCEAJM3IYIAgzcAAJM3IYIAgzcAhACTNx6CAIM3AACTNx6CAIM3AIQAkzccggCDNwAAkzcbggCDNwCEAJM3GoIAgzcAAJM3GYIAgzcAhACTNxeCAIM3AACTNxaCAIM3AIQAkzcVggCDNwAAkzcUggCDNwCEAJM3EoIAgzcAAJM3EoIAgzcAhACTNxCCAIM3AACTNw+CAIM3AIQAkzcNggCDNwAAkzcNggCDNwCEAJM3CoIAgzcAAJM3CoIAgzcAhACTNwiCAIM3AACTNweCAIM3AIQAkzcGggCDNwAAkzcFggCDNwCEAJM3A4IAgzcAAJM3AoIAgzcAhACTNwGCAIM3AAH/LwA=");
		
		var length = binary.length;
		
		var bytes = new Uint8Array(length);
		
		for(var i = 0; i < length; i++)
			bytes[i] = binary.charCodeAt(i);
		
		var stream = new MIDIStream(bytes.buffer);
		
		var file = new MIDIFile();
		
		file.readBytes(stream);
		
		return file;
	}
	
	window.App = function()
	{
		var temp = getTestMIDI();
		
		this.kalimba	= new Kalimba($("#kalimba"));
		this.tracks		= new Tracks($("#tracks"));
		
		this.tracks.update(temp);
		
		this.tablature	= Tablature.fromMIDI($("#tablature"), this.kalimba, temp);
		
	}
	
	window.app = new App();
	
});